# Makefile 

.PHONY: all clean

CPP = @CPP@
CPPFLAGS = $(strip @CPPFLAGS@)
DEFS = @DEFS@

MPIFC = @MPIFC@
FCFLAGS = $(strip @FCFLAGS@)

objects = module_stream_nudging.o module_nudging_io.o		\
          module_nudging_utils.o module_date_utils_nudging.o

all:	$(objects)

module_nudging_utils.o module_date_utils_nudging.o: %.o: %.f
	$(MPIFC) -o $@ $(FCFLAGS) $(addprefix -I,$(^D)) $<

module_nudging_io.o: %.o: %.f ../MPP/mpp_land.o ../Data_Rec/module_namelist.o
	$(MPIFC) -o $@ $(FCFLAGS) $(addprefix -I,$(^D)) $<

module_stream_nudging.o: %.o: %.f module_nudging_io.o	\
                         module_nudging_utils.o		\
                         module_date_utils_nudging.o	\
                         ../MPP/mpp_land.o		\
                         ../Data_Rec/module_namelist.o
	$(MPIFC) -o $@ $(FCFLAGS) $(addprefix -I,$(sort $(^D))) $<

%.f: %.F
	$(CPP) $(CPPFLAGS) $(DEFS) $< > $@

clean:
	rm -f *.o *.mod *.stb *~ *.f
