# Makefile.in

CPP = @CPP@
CPPFLAGS = @CPPFLAGS@
NETCDF4_CFLAGS = @NETCDF4_CFLAGS@

FC = @FC@
FCFLAGS = @FCFLAGS@

objects = \
  $(addsuffix .o, \
	CPL_WRF mpp_land module_mpp_ReachLS module_mpp_GWBUCKET)

all: $(objects)

# TODO: move "ar" commands below to ../Makefile.in?

mpp_land.o: mpp_land.F
	$(FC) $(FCFLAGS) $(LDFLAGS) -c $(*).F
	ar -r ../lib/libHYDRO.a $(@)

CPL_WRF.o: CPL_WRF.F
	$(CPP) $(CPPFLAGS) $(NETCDF4_CFLAGS) $(*).F > $(*).f
	$(FC) -o $(@) $(FCFLAGS) $(LDFLAGS) $(MODFLAG) $(*).f
	$(FC) $(FCFLAGS) $(LDFLAGS) -c $(*).F
	ar -r ../lib/libHYDRO.a $(@)

module_mpp_ReachLS.o: module_mpp_ReachLS.F
	$(FC) $(FCFLAGS) $(LDFLAGS) -c $(*).F
	ar -r ../lib/libHYDRO.a $(@)

module_mpp_GWBUCKET.o: module_mpp_GWBUCKET.F
	$(FC) $(FCFLAGS) $(LDFLAGS) -c $(*).F
	ar -r ../lib/libHYDRO.a $(@)

clean:
	rm -f *.o *.mod *.s *.stb *~
