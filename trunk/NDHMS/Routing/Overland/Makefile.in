# Makefile.in

# simple compilation test for modules in overland routing

.PHONY: all test clean

MPIFC = @MPIFC@
FFLAGS = @FFLAGS@
FCFLAGS = $(strip @FCFLAGS@)

objects = \
  $(addsuffix .o,\
    $(addprefix module_overland_,control streams_and_lakes	\
	routing_properties mass_balance))

all: $(objects) module_overland.o

$(objects): %.o: %.F
	$(MPIFC) $(FCFLAGS) $<

module_overland.o: %.o: %.F module_overland_control.o \
                   module_overland_streams_and_lakes.o \
                   module_overland_routing_properties.o \
                   module_overland_mass_balance.o
	$(MPIFC) $(FCFLAGS) $<

test: overland_tests

overland_tests: overland_tests.o $(objects)
	$(MPIFC) $(FCFLAGS) -o overland_tests $(objects) $<

overland_tests.o:
	$(MPIFC) $(FCFLAGS) overland_tests.F

clean:
	rm -f *.o *.mod *.s overland_tests *~
