# Makefile.in

.PHONY: all clean

MPIFC = @MPIFC@
FCFLAGS = @FCFLAGS@
CPP = @CPP@
CPPFLAGS = @CPPFLAGS@

objects = hrldas_drv_HYDRO.o module_hrldas_HYDRO.o

all: libNoahMP_cpl.a

libNoahMP_cpl.a: $(objects) 
	ar -r $@ $?

hrldas_drv_HYDRO.o: hrldas_drv_HYDRO.f module_hrldas_HYDRO.o	\
                    ../../Routing/module_lsm_forcing.o
	$(MPIFC) -o $@ $(FCFLAGS) -I../../Routing -I../../Data_Rec	\
                 -I../../MPP hrldas_drv_HYDRO.f

module_hrldas_HYDRO.o: module_hrldas_HYDRO.f	\
	../../HYDRO_drv/module_HYDRO_drv.o	\
	../../Data_Rec/module_RT_data.o
	$(MPIFC) -o $@ $(FCFLAGS) -I../../MPP -I../../HYDRO_drv	\
	-I../../Data_Rec module_hrldas_HYDRO.f

../../HYDRO_drv/module_HYDRO_drv.o:
	cd $(dir $@) && make $(notdir $@)

%.f: %.F
	$(CPP) $(CPPFLAGS) $< > $@

clean:
	rm -f *.o *.mod *.stb *~ *.f Noah_hrldas_beta libNoahMP_cpl.a
