# Makefile.in

.PHONY: all clean

CPP = @CPP@
CPPFLAGS = @CPPFLAGS@
DEFS = @DEFS@

MPIFC = @MPIFC@
FCFLAGS = @FCFLAGS@

objects = hrldas_drv_HYDRO.o module_hrldas_HYDRO.o

all: libNoahMP_cpl.a

libNoahMP_cpl.a: $(objects)
	ar -r $@ $?

module_hrldas_HYDRO.o: %.o: %.f
	$(MPIFC) -o $@ $(FCFLAGS) \
	  $(addprefix -I../../,Data_Rec HYDRO_drv MPP) $<

hrldas_drv_HYDRO.o: %.o: %.f module_hrldas_HYDRO.o
	$(MPIFC) -o $@ $(FCFLAGS) \
          $(addprefix -I../../,Data_Rec MPP Routing) $<

%.f: %.F
	$(CPP) $(CPPFLAGS) $(DEFS) $< > $@

clean:
	rm -f *.o *.mod *.stb *~ *.f Noah_hrldas_beta libNoahMP_cpl.a
