# Makefile.in

.SUFFIXES:
.SUFFIXES: .o .F

ifeq ($(HYDRO_REALTIME),1)
HYDRO_REALTIME = -DHYDRO_REALTIME
else
HYDRO_REALTIME =
endif

ifeq ($(WRF_HYDRO),1)
WRF_HYDRO = -DWRF_HYDRO $(HYDRO_REALTIME)
else
WRF_HYDRO =
endif

ifeq ($(HYDRO_D),1)
HYDRO_D = -DHYDRO_D $(WRF_HYDRO)
else
HYDRO_D = $(WRF_HYDRO)
endif

ifeq ($(WRF_HYDRO_NUDGING),1)
WRF_HYDRO_NUDGING = -DWRF_HYDRO_NUDGING
else
WRF_HYDRO_NUDGING = 
endif

MPIFC = @MPIFC@
FCFLAGS = @FCFLAGS@ -w -c -ffree-form -ffree-line-length-none -fconvert=big-endian -frecord-marker=4
CPP = @CPP@
CPPFLAGS = -P -xassembler-with-cpp -traditional -DMPP_LAND -I../Data_Rec $(HYDRO_D) $(WRF_HYDRO_NUDGING)

include ../global.mk

all: $(HYDRO_drv_objects)

.F.o:
	$(CPP) $(CPPFLAGS) $(*).F > $(*).f
	$(MPIFC) -o $(@) $(FCFLAGS) -I../Routing -I../MPP -I../Data_Rec $(*).f
# TODO:	ar -r ../lib/libHYDRO.a $(@)
# TODO:	cp *.mod ../mod

module_HYDRO_drv.o: $(Data_Rec_objects) $(addprefix ../Routing/,module_GW_baseflow.o module_HYDRO_utils.o module_HYDRO_io.o module_RT.o)

clean:
	rm -f *.o *.mod *.stb *~ *.f
